### 5.1 Учимся обрабатывать пропуски

---
#### 5.1.1-5.1.3 Обнаружение пропущенных значений

Pandas использует `NaN` (Not a Number) для представления пропущенных данных. Функции `.isnull()` и `.notnull()` возвращают булеву маску, указывающую на наличие или отсутствие пропусков. Они распознают как `np.nan`, так и `None`.

**--- Исходные данные ---**
```python
df = pd.DataFrame([
    [1, 2, 3],
    [4, np.nan, 6],
    [7, None, 9]
], columns=['A', 'B', 'C'])

print("Исходный DataFrame:")
print(df)
```
**Вывод:**
```
Исходный DataFrame:
   A    B  C
0  1  2.0  3
1  4  NaN  6
2  7  NaN  9
```

**--- Применение функций ---**
```python
# .isnull() возвращает True, где есть пропуск
print("\nРезультат df.isnull():")
print(df.isnull())

# .notnull() возвращает True, где есть данные
print("\nРезультат df.notnull():")
print(df.notnull())
```
**Вывод:**
```
Результат df.isnull():
       A      B      C
0  False  False  False
1  False   True  False
2  False   True  False

Результат df.notnull():
      A      B     C
0  True   True  True
1  True  False  True
2  True  False  True
```
---
#### 5.1.4-5.1.8 Удаление пропущенных значений (`.dropna()`)

`.dropna()` — это основной инструмент для фильтрации пропущенных данных.

**--- Исходные данные для примеров ---**
```python
df_drop = pd.DataFrame([
    [1, 2, 3, 4],
    [np.nan, 6, 7, np.nan],
    [9, 10, np.nan, 12],
    [np.nan, np.nan, np.nan, np.nan]
], columns=['A', 'B', 'C', 'D'])

print("Исходный DataFrame:")
print(df_drop)
```
**Вывод:**
```
Исходный DataFrame:
     A     B     C     D
0  1.0   2.0   3.0   4.0
1  NaN   6.0   7.0   NaN
2  9.0  10.0   NaN  12.0
3  NaN   NaN   NaN   NaN
```
---
**1. Поведение по умолчанию (`how='any'`, `axis=0`)**
Удаляет любую **строку**, в которой есть **хотя бы один** `NaN`.

```python
print("\nРезультат df.dropna() (по умолчанию):")
print(df_drop.dropna())
```
**Вывод:** (Осталась только первая строка, так как в остальных были пропуски)
```
Результат df.dropna() (по умолчанию):
     A    B    C    D
0  1.0  2.0  3.0  4.0
```
---
**2. Параметр `how='all'`**
Удаляет строку (или столбец), только если **все** значения в ней являются `NaN`.

```python
print("\nРезультат df.dropna(how='all'):")
print(df_drop.dropna(how='all'))
```
**Вывод:** (Удалилась только последняя, полностью пустая строка)
```
Результат df.dropna(how='all'):
     A     B    C     D
0  1.0   2.0  3.0   4.0
1  NaN   6.0  7.0   NaN
2  9.0  10.0  NaN  12.0
```
---
**3. Параметр `axis=1`**
Применяет операцию не к строкам, а к **столбцам**.

```python
print("\nРезультат df.dropna(axis=1):")
print(df_drop.dropna(axis=1))
```
**Вывод:** (Удалились столбцы 'A', 'C', 'D', так как в них были пропуски)
```
Результат df.dropna(axis=1):
      B
0   2.0
1   6.0
2  10.0
3   NaN
```
---
#### 5.1.9 Параметр `thresh` (порог)

Параметр `thresh` (threshold) позволяет оставить строки (или столбцы), в которых есть как минимум `N` **непропущенных** (валидных) значений.

**--- Исходные данные те же ---**
```python
print("Исходный DataFrame:")
print(df_drop)
```
**Вывод:**
```
Исходный DataFrame:
     A     B     C     D
0  1.0   2.0   3.0   4.0  (4 валидных значения)
1  NaN   6.0   7.0   NaN  (2 валидных значения)
2  9.0  10.0   NaN  12.0  (3 валидных значения)
3  NaN   NaN   NaN   NaN  (0 валидных значений)
```
---
**--- Применение `thresh` ---**
```python
# Оставляем только те строки, где есть МИНИМУМ 3 валидных значения
print("\nРезультат df.dropna(thresh=3):")
print(df_drop.dropna(thresh=3))
```
**Вывод:** (Строка 1 была удалена, так как в ней всего 2 валидных значения)
```
Результат df.dropna(thresh=3):
     A     B    C     D
0  1.0   2.0  3.0   4.0
2  9.0  10.0  NaN  12.0
```
